<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æœ¬åœ°å­˜å‚¨æµ‹è¯•</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #e53e3e;
        }
        button {
            background: #e53e3e;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
            font-size: 14px;
        }
        button:hover {
            background: #c53030;
        }
        pre {
            background: #f7fafc;
            padding: 15px;
            border-radius: 4px;
            overflow-x: auto;
            font-size: 12px;
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
        }
        .success {
            background: #c6f6d5;
            color: #22543d;
        }
        .error {
            background: #fed7d7;
            color: #742a2a;
        }
        .info {
            background: #bee3f8;
            color: #2a4365;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ§ª æœ¬åœ°å­˜å‚¨æµ‹è¯•å·¥å…·</h1>
        
        <div class="status info">
            <strong>å­˜å‚¨é”®åï¼š</strong> spring-fest-calorie-data
        </div>

        <div style="margin: 20px 0;">
            <button onclick="checkStorage()">ğŸ“‹ æ£€æŸ¥å­˜å‚¨</button>
            <button onclick="showStorage()">ğŸ‘€ æ˜¾ç¤ºæ•°æ®</button>
            <button onclick="clearStorage()">ğŸ—‘ï¸ æ¸…ç©ºå­˜å‚¨</button>
            <button onclick="testWrite()">âœï¸ æµ‹è¯•å†™å…¥</button>
        </div>

        <div id="output"></div>

        <div style="margin-top: 30px;">
            <h2>ğŸ“Š å½“å‰å­˜å‚¨å†…å®¹</h2>
            <pre id="storageContent">ç‚¹å‡»"æ˜¾ç¤ºæ•°æ®"æŸ¥çœ‹</pre>
        </div>
    </div>

    <script>
        const STORAGE_KEY = 'spring-fest-calorie-data';

        function output(message, type = 'info') {
            const div = document.createElement('div');
            div.className = `status ${type}`;
            div.innerHTML = message;
            document.getElementById('output').appendChild(div);
            
            // 5ç§’åè‡ªåŠ¨ç§»é™¤
            setTimeout(() => div.remove(), 5000);
        }

        function checkStorage() {
            const data = localStorage.getItem(STORAGE_KEY);
            if (data === null) {
                output('âŒ å­˜å‚¨ä¸­æ— æ•°æ®', 'error');
            } else {
                output(`âœ… æ‰¾åˆ°æ•°æ®ï¼Œå¤§å°: ${data.length} å­—èŠ‚`, 'success');
            }
        }

        function showStorage() {
            const data = localStorage.getItem(STORAGE_KEY);
            const contentEl = document.getElementById('storageContent');
            
            if (data === null) {
                contentEl.textContent = 'å­˜å‚¨ä¸­æ— æ•°æ®';
            } else {
                try {
                    const parsed = JSON.parse(data);
                    contentEl.textContent = JSON.stringify(parsed, null, 2);
                    output('âœ… æ•°æ®æ˜¾ç¤ºæˆåŠŸ', 'success');
                } catch (e) {
                    contentEl.textContent = 'æ•°æ®è§£æå¤±è´¥: ' + e.message;
                    output('âŒ æ•°æ®æ ¼å¼é”™è¯¯', 'error');
                }
            }
        }

        function clearStorage() {
            if (confirm('ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰å­˜å‚¨æ•°æ®å—ï¼Ÿ')) {
                localStorage.removeItem(STORAGE_KEY);
                output('âœ… å­˜å‚¨å·²æ¸…ç©º', 'success');
                document.getElementById('storageContent').textContent = 'å­˜å‚¨å·²æ¸…ç©º';
            }
        }

        function testWrite() {
            const testData = {
                dailyRecords: {
                    '2026-02-06': {
                        date: '2026-02-06',
                        selectedDishes: [{ id: 1, quantity: 150 }],
                        totalCalories: 480,
                        totalProtein: 27,
                        totalFat: 36,
                        totalCarbs: 4.5,
                        customDishes: [],
                        savedToHistory: false,
                        lastModified: new Date().toISOString()
                    }
                },
                customDishes: [],
                preferences: {
                    defaultCuisine: 'å…¨éƒ¨',
                    defaultType: 'å…¨éƒ¨',
                    enableNotifications: false
                }
            };
            
            try {
                localStorage.setItem(STORAGE_KEY, JSON.stringify(testData));
                output('âœ… æµ‹è¯•æ•°æ®å†™å…¥æˆåŠŸ', 'success');
                showStorage();
            } catch (e) {
                output('âŒ å†™å…¥å¤±è´¥: ' + e.message, 'error');
            }
        }

        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨æ£€æŸ¥
        window.onload = function() {
            checkStorage();
        };
    </script>
</body>
</html>